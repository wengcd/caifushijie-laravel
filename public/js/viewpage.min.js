var $$=function(a){return document.getElementById(a)};var isIE=!!window.ActiveXObject;var isIE6=isIE&&!window.XMLHttpRequest;var ie=document.all;var nn6=document.getElementById&&!document.all;var isdrag=false;var x,y;var dobj;function movemouse(a){if(isdrag){dobj.style.left=(nn6?tx+a.clientX-x:tx+event.clientX-x)+"px";dobj.style.top=(nn6?ty+a.clientY-y:ty+event.clientY-y)+"px";return false}}function selectmouse(b){var c=nn6?b.target:event.srcElement;var a=nn6?"HTML":"BODY";while(c.tagName!=a&&c.className!="dragme"){c=nn6?c.parentNode:c.parentElement}if(c.className=="dragme"){isdrag=true;dobj=c;tx=parseInt(dobj.style.left+0);ty=parseInt(dobj.style.top+0);x=nn6?b.clientX:event.clientX;y=nn6?b.clientY:event.clientY;document.onmousemove=movemouse;return false}}var isIeWheel=navigator.userAgent.indexOf("MSIE")>0?true:false;function zoomimg(d){var h;if(ie){h=event}else{h=d}if(h.altKey){var l=0;if(d.wheelDelta){l=d.wheelDelta/120;if(window.opera){l=-l}}else{if(d.detail){l=-d.detail/3}}var n=nn6?d.target:d.srcElement;var a=nn6?"HTML":"BODY";while(n.tagName!=a&&n.className!="page_image"){n=nn6?n.parentNode:n.parentElement}if(n.className=="page_image"){var c=l;var i=0;var m=0;var k=10;var j=10;var f=50;var b=80;if(isIeWheel){var g=parseInt(n.style.zoom)||100;g+=k*c;if(g>0){n.style.zoom=g+"%"}}else{if(n.width>n.height){m=n.height+j*c;i=n.width*m/n.height}else{i=n.width+j*c;m=n.height*i/n.width}if(i>f&&m>b){n.width=i;n.height=m}}}if(d.preventDefault){d.preventDefault()}d.returnValue=false}}function checkLogin(b){if(userId==null||userId==""){if(b!=undefined&&b!=null&&b==true){}else{if(confirm("\u60a8\u8fd8\u6ca1\u6709\u767b\u5f55\uff0c\u767b\u5f55\u4e4b\u540e\u5c31\u80fd\u4f7f\u7528\u6b64\u529f\u80fd\u3002\u662f\u5426\u73b0\u5728\u5c31\u53bb\u767b\u5f55\uff1f")){var a=window.location.href;window.location.href="/account/login.aspx?retUrl="+a;return false}}return false}else{return true}}function movePageImage(a){if(dobj==null){dobj=$(".dragme")[0]}tx=parseInt(dobj.style.left+0);ty=parseInt(dobj.style.top+0);step=20;if(a==1){ty=ty-step}else{if(a==2){tx=tx+step}else{if(a==3){ty=ty+step}else{if(a==4){tx=tx-step}}}}dobj.style.left=tx+"px";dobj.style.top=ty+"px"}function regKeyEvent(g){var d;if(ie){d=event}else{d=g}if(d.keyCode==90&&d.shiftKey){var f=document.getElementById("pageShowSel");var c=f.selectedIndex;var a=f.options[c].value;if(a=="0"){iheight=document.body.clientHeight;adjustImageSize(image,0,iheight);f.options[1].selected=true}else{if(a=="1"){iwidth=$$("pic_container").offsetWidth;adjustImageSize(image,iwidth,0);f.options[0].selected=true}else{if(a=="2"){picWidth=image.width;picHeight=image.height;pagePic.width=picWidth;pagePic.height=picHeight;f.options[2].selected=true}}}}if(d.keyCode==65&&d.shiftKey){var b="/pages/"+last_page_id;if(show_jpg==1){b=b+"/1"}window.location.href=b}if(d.keyCode==83&&d.shiftKey){var b="/pages/"+next_page_id;if(show_jpg==1){b=b+"/1"}window.location.href=b}if(d.keyCode==68&&d.shiftKey){window.location.href="/issue/"+issueId}if(d.keyCode==88&&d.shiftKey){window.location.href="/"}if(d.keyCode==37){movePageImage(4)}if(d.keyCode==38){movePageImage(1)}if(d.keyCode==39){movePageImage(2)}if(d.keyCode==40){movePageImage(3)}}function rememberPageSize(c){if(c.checked){var c=document.getElementById("pageShowSel");var b=c.selectedIndex;var a=c.options[b].value;$.cookie("PageSize",a,{expires:90})}else{$.cookie("PageSize","",{expires:-1})}}document.onmousedown=selectmouse;document.onmouseup=new Function("isdrag=false");if(document.attachEvent){document.attachEvent("onmousewheel",zoomimg)}else{window.addEventListener("DOMMouseScroll",zoomimg,false)}document.onkeydown=regKeyEvent;function cuteImage(c,a,d){var b="/CutePage.aspx?imageurl="+c;b=b+"&pageid="+a;if(d!=null&&d!=""){window.open(b)}else{if(confirm("\u60a8\u8fd8\u6ca1\u6709\u767b\u5f55\uff0c\u65e0\u6cd5\u526a\u62a5\u3002\u662f\u5426\u73b0\u5728\u5c31\u53bb\u767b\u5f55\uff1f")){var b=window.location.href;window.location.href="/account/login.aspx?retUrl="+b}}}function goToPage(){var b=document.getElementById("pageOrder").value;var a="/pages/"+b;if(show_jpg==1){a=a+"/1"}window.location.href=a}function show_toolbar(){var a=document.getElementById&&!document.all;if(document.getElementById("toolbar_content").style.display=="none"){document.getElementById("ctr_ico").src="/new_images/kbym-an1.gif";document.getElementById("toolbar_content").style.display=""}else{if(document.getElementById("toolbar_content").style.display==""){document.getElementById("ctr_ico").src="/new_images/kbym-an2.gif";document.getElementById("toolbar_content").style.display="none"}}}function pop_help(){if($$("pop_help").style.display=="none"){$$("pop_help").style.display="block";$$("fade").style.display="block"}else{$$("pop_help").style.display="none";$$("fade").style.display="none"}}function adjustImageSize(b,a,c){b.style.zoom="100%";pagePic.style.zoom="100%";if(picWidth>0&&picHeight>0){if(a>0){pagePic.width=a;pagePic.height=a*picHeight/picWidth}if(c>0){pagePic.height=c;pagePic.width=c*picWidth/picHeight}}rememberPageSize(document.getElementById("rememberSize"))}function defualtPageSize(){if($.cookie("PageSize")){document.getElementById("rememberSize").checked=true;var b=$.cookie("PageSize");if(b==0){iwidth=$$("pic_container").offsetWidth-20;var a=document.getElementById("pageShowSel");a.options[0].selected=true;adjustImageSize(image,iwidth,0)}else{if(b==2){iheight=document.body.clientHeight;var a=document.getElementById("pageShowSel");a.options[1].selected=true;adjustImageSize(image,0,iheight)}else{var a=document.getElementById("pageShowSel");a.options[2].selected=true}}}else{var a=document.getElementById("pageShowSel");a.options[0].selected=true;adjustImageSize(image,iwidth,0)}}function adjustPageSize(c){var b=c.selectedIndex;var a=c.options[b].value;if(a=="0"){iwidth=$$("pic_container").offsetWidth-20;adjustImageSize(image,iwidth,0)}else{if(a=="1"){picWidth=image.width;picHeight=image.height;pagePic.width=picWidth;pagePic.height=picHeight;rememberPageSize(document.getElementById("rememberSize"))}else{if(a=="2"){iheight=document.body.clientHeight;adjustImageSize(image,0,iheight)}}}}function Ajax(){var d=null;if(window.XMLHttpRequest){d=new XMLHttpRequest()}else{if(window.ActiveXObject){var a=["Microsoft.XMLHTTP","MSXML.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.7.0","Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP"];for(var b=0;b<a.length;b++){try{d=new ActiveXObject(a[b]);if(d){break}}catch(f){}}}}var c=null;this.invoke=function(j,h,i,g){c=g;if(j=="get"){var e=h+"?"+i+"&t="+Math.random();if(window.XMLHttpRequest){d.open("GET",e,true);d.onreadystatechange=this.callback;d.send(null)}else{d.open("GET",e,true);d.onreadystatechange=this.callback;d.send()}}else{if(j=="post"){d.open("POST",h);d.onreadystatechange=this.callback;d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(i)}}};this.callback=function(){if(d.readyState==4){if(d.status==200){c(d.responseText)}else{}}}}function pop_page_txt_content(){if($$("page_txt_content").style.display=="none"){$$("page_txt_content").style.display="block";$$("fade").style.display="block"}else{$$("page_txt_content").style.display="none";$$("fade").style.display="none"}}function pop_page_txt_content(a){if($$("page_txt_content").style.display=="none"){if($$("page_txt_content_data").innerHTML==""){var b="page_id="+a;new Ajax().invoke("get","/webapi/page_text_content",b,function(d){var c=d;$$("page_txt_content_data").innerHTML=c;$$("page_txt_content").style.display="block";$$("fade").style.display="block"})}else{$$("page_txt_content").style.display="block";$$("fade").style.display="block"}}else{$$("page_txt_content").style.display="none";$$("fade").style.display="none"}}function mobile_detect(f,e,a,g,b){var d=(/iphone|ipod|android/i.test(navigator.userAgent.toLowerCase()));var c=(/ipad|android/i.test(navigator.userAgent.toLowerCase()));if(b==true){alert(navigator.userAgent)}if(d&&f==true){if(b==true){alert("Mobile Browser")}window.location=a}else{if(c&&e==true){if(b==true){alert("Tablet Browser")}window.location=g}}}var qqlogin=function(){var b=203503;var d=window.location.href;var c="http://www.abbao.cn/third_oauth/qqcallback?callback="+encodeURIComponent(d);var a="https://graph.qq.com/oauth2.0/authorize?response_type=code&client_id="+b+"&redirect_uri="+encodeURIComponent(c);window.location.href=a};var sinalogin=function(){var c=211403187;var d=window.location.href;var a="http://www.abbao.cn/third_oauth/sinacallback?callback="+encodeURIComponent(d);var b="https://api.weibo.com/oauth2/authorize?response_type=code&client_id="+c+"&redirect_uri="+encodeURIComponent(a);window.location.href=b};function submit(c){var b=(document.all)?true:false;var a;if(b){a=window.event.keyCode}else{a=c.which}if(a==13){login()}}var login=function(){var c=$$("userCode").value;if(c==null||c==""){alert("\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a");$$("userCode").focus();return}var a=$$("password").value;if(a==null||a==""){alert("\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a");$$("password").focus();return}var b="userCode="+c+"&password="+a;new Ajax().invoke("post","/oauth/checkUser",b,function(d){var e=JSON.parse(d);if(e!=null&&e.result!=null&&e.result==0){$$("popLogin").style.display="none";window.location.reload()}else{if(e!=null&&e.result!=null){if(e.result==5){alert("\u5e10\u53f7\u5df2\u7ecf\u88ab\u9501\u5b9a,\u767b\u5f55\u5931\u8d25.")}else{alert("\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u4e0d\u6b63\u786e,\u767b\u5f55\u5931\u8d25.")}}else{alert("\u7cfb\u7edf\u5f02\u5e38,\u8bf7\u7a0d\u540e\u91cd\u8bd5.")}}})};var goGame=function(b,c){var a="/oauth/jump?app_id=app_id="+b+"&callback="+encodeURIComponent(c);window.open(a)};var showToolBar=function(){var d=document.documentElement.clientWidth;var a=document.documentElement.clientHeight;var b=40;var c=177;if(a<730){if(document.all){if(isIE6){c=c+10;$$("toolbar_container").style.width="186px";b=b-14}else{c=c-7;$$("toolbar_container").style.width="186px";b=b+4}}else{c=c-7;$$("toolbar_container").style.width="186px";b=b-4}document.body.style.overflow="hidden";$$("toolbar_container").style.overflowY="auto";window.setTimeout(function(){$$("toolbar_container").scrollTop=b},2000)}else{if(document.all){if(isIE6){c=c}else{c=c}}else{c=c}document.body.style.overflow="hidden";$$("toolbar_container").style.overflow="hidden"}$$("pic_container").style.width=(d-c)+"px";$$("pic_container").style.height=a+"px";$$("left_container").style.width=(d-c)+"px";$$("left_container").style.height=a+"px";$$("toolbar_container").style.height=a+"px";$$("container").style.height=a+"px";document.body.style.height=a+"px"};var interval1=null;var $$=function(a){return document.getElementById(a)};var image=new Image();var pagePic=null;var picWidth=0;var picHeight=0;var iwidth=0;var iheight=0;$(function(){pagePic=$$("page_image");picWidth=0;picHeight=0;iwidth=$$("pic_container").offsetWidth-20;iheight=document.body.clientHeight;document.getElementById("rememberSize").onchange=function(){rememberPageSize(this)};image.src=pagePic.src;image.onload=function(){picWidth=image.width;picHeight=image.height;defualtPageSize()};showToolBar();window.onresize=showToolBar;iwidth=$$("pic_container").offsetWidth-20});